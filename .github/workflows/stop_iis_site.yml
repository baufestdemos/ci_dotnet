name: Stop IIS Site
run-name:  ${{inputs.site-name}} - Stop IIS Site

on:
  workflow_dispatch:
    inputs:        
      site-name:
        required: true
        type: choice
        options:
        - apidemo
        - spabffdemo
        - all
        
      env-profile:
        required: true
        type: choice
        options:
        - Staging
        - Release
        
  workflow_call:
    inputs:  
      service-name:
        required: true
        type: string 

      env-profile:
        required: true
        type: string
            
jobs:
  stop_application:
    name: Stop IIS Site
    runs-on: [self-hosted, "${{ inputs.env-profile }}"]
    steps:
      - name: Stop site apidemo
        uses: 1k-off/iis-apppool-action@1.0.0
        if: ${{ inputs.site-name == 'apidemo' || inputs.site-name == 'all'}}
        with:
          action: stop
          appPoolName: apidemo
          siteName: apidemo
        

        
